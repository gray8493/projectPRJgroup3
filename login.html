<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ÄÄƒng nháº­p - POS Cafe</title>
  <link rel="stylesheet" href="./assets/css/style.css">
</head>
<body>
  <div class="center-screen">
    <div class="auth-box card">
      <div class="panel-header">
        <div class="brand">POS Cafe</div>
        <span class="badge">Há»‡ thá»‘ng quáº£n lÃ½</span>
      </div>
      <div class="panel-body">
        <!-- Tab Navigation -->
        <div class="auth-tabs">
          <button class="auth-tab active" data-tab="login">ÄÄƒng nháº­p</button>
          <button class="auth-tab" data-tab="register">ÄÄƒng kÃ½</button>
        </div>

        <!-- Login Tab -->
        <div id="login-tab" class="auth-tab-content active">
          <div class="grid">
            <div>
              <label class="note">TÃ i khoáº£n nhÃ¢n viÃªn</label>
              <input id="username" class="input" placeholder="VD: admin" value="admin">
            </div>
            <div>
              <label class="note">Máº­t kháº©u</label>
              <div style="display:flex; gap:8px; align-items:center;">
                <input id="password" type="password" class="input" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" value="123456" style="flex:1;">
                <button id="togglePwd" type="button" class="btn" aria-label="Hiá»‡n/áº©n máº­t kháº©u">ğŸ‘</button>
              </div>
            </div>
            <button id="btnLogin" class="btn btn-primary">ÄÄƒng nháº­p Admin</button>
            <div class="note" style="text-align: center; margin-top: 1rem;">
              <a href="menu.html" style="color: var(--color-primary); text-decoration: none;">â† Xem menu khÃ¡ch hÃ ng</a>
            </div>
          </div>
        </div>

        <!-- Register Tab -->
        <div id="register-tab" class="auth-tab-content">
          <div class="grid">
            <div>
              <label class="note">Há» vÃ  tÃªn</label>
              <input id="regName" class="input" placeholder="Nháº­p há» vÃ  tÃªn">
            </div>
            <div>
              <label class="note">TÃ i khoáº£n</label>
              <input id="regUsername" class="input" placeholder="TÃªn Ä‘Äƒng nháº­p">
            </div>
            <div>
              <label class="note">Máº­t kháº©u</label>
              <div style="display:flex; gap:8px; align-items:center;">
                <input id="regPassword" type="password" class="input" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" style="flex:1;">
                <button id="toggleRegPwd" type="button" class="btn" aria-label="Hiá»‡n/áº©n máº­t kháº©u">ğŸ‘</button>
              </div>
            </div>
            <div>
              <label class="note">XÃ¡c nháº­n máº­t kháº©u</label>
              <input id="regConfirmPassword" type="password" class="input" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢">
            </div>
            <div>
              <label class="note">Sá»‘ Ä‘iá»‡n thoáº¡i</label>
              <input id="regPhone" class="input" placeholder="Sá»‘ Ä‘iá»‡n thoáº¡i">
            </div>
            <button id="btnRegister" class="btn btn-secondary">ÄÄƒng kÃ½ tÃ i khoáº£n</button>
            <div class="note" style="text-align: center; margin-top: 1rem;">
              <a href="menu.html" style="color: var(--color-primary); text-decoration: none;">â† Xem menu khÃ¡ch hÃ ng</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<script>
  // Tab navigation
  function initAuthTabs() {
    const authTabs = document.querySelectorAll('.auth-tab');
    const tabContents = document.querySelectorAll('.auth-tab-content');

    authTabs.forEach(tab => {
      tab.addEventListener('click', () => {
        // Remove active class from all tabs and contents
        authTabs.forEach(t => t.classList.remove('active'));
        tabContents.forEach(c => c.classList.remove('active'));
        
        // Add active class to clicked tab and corresponding content
        tab.classList.add('active');
        const tabId = tab.getAttribute('data-tab');
        const content = document.getElementById(tabId + '-tab');
        if(content) {
          content.classList.add('active');
        }
      });
    });
  }

  // Password toggle functions
  document.getElementById('togglePwd').addEventListener('click', function(){
    const pwd = document.getElementById('password');
    pwd.type = (pwd.type === 'password') ? 'text' : 'password';
  });

  document.getElementById('toggleRegPwd').addEventListener('click', function(){
    const pwd = document.getElementById('regPassword');
    pwd.type = (pwd.type === 'password') ? 'text' : 'password';
  });

  // Login function
  document.getElementById('btnLogin').addEventListener('click', function(){
    const u = document.getElementById('username').value.trim();
    const p = document.getElementById('password').value.trim();
    if(u && p){
      // Check if user exists in localStorage
      const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
      const user = users.find(user => user.username === u && user.password === p);
      
      if(u === 'admin' && p === '123456') {
        // Default admin account
        sessionStorage.setItem('auth', '1');
        sessionStorage.setItem('userRole', 'admin');
        sessionStorage.setItem('userName', 'Admin');
        window.location.href = 'store-selection.html';
      } else if(user) {
        // Registered user
        sessionStorage.setItem('auth', '1');
        sessionStorage.setItem('userRole', 'staff');
        sessionStorage.setItem('userName', user.name);
        window.location.href = 'store-selection.html';
      } else {
        alert('TÃ i khoáº£n hoáº·c máº­t kháº©u khÃ´ng Ä‘Ãºng!');
      }
    } else {
      alert('Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ thÃ´ng tin!');
    }
  });

  // Register function
  document.getElementById('btnRegister').addEventListener('click', function(){
    const name = document.getElementById('regName').value.trim();
    const username = document.getElementById('regUsername').value.trim();
    const password = document.getElementById('regPassword').value.trim();
    const confirmPassword = document.getElementById('regConfirmPassword').value.trim();
    const phone = document.getElementById('regPhone').value.trim();

    if(!name || !username || !password || !confirmPassword || !phone) {
      alert('Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ thÃ´ng tin!');
      return;
    }

    if(password !== confirmPassword) {
      alert('Máº­t kháº©u xÃ¡c nháº­n khÃ´ng khá»›p!');
      return;
    }

    if(password.length < 6) {
      alert('Máº­t kháº©u pháº£i cÃ³ Ã­t nháº¥t 6 kÃ½ tá»±!');
      return;
    }

    // Check if username already exists
    const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
    if(users.find(user => user.username === username)) {
      alert('TÃªn Ä‘Äƒng nháº­p Ä‘Ã£ tá»“n táº¡i!');
      return;
    }

    // Add new user
    const newUser = {
      name: name,
      username: username,
      password: password,
      phone: phone,
      createdAt: new Date().toISOString()
    };

    users.push(newUser);
    localStorage.setItem('registeredUsers', JSON.stringify(users));

    alert('ÄÄƒng kÃ½ thÃ nh cÃ´ng! Báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p ngay bÃ¢y giá».');
    
    // Switch to login tab
    document.querySelector('[data-tab="login"]').click();
    
    // Fill username field
    document.getElementById('username').value = username;
  });

  // Initialize tabs
  initAuthTabs();
</script>
</body>
</html>
